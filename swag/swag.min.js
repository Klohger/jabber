"use strict";var SOURCE_CONNECTOR,l=this&&this.__awaiter||function(e,i,l,c){return new(l=l||Promise)(function(n,t){function o(e){try{r(c.next(e))}catch(e){t(e)}}function E(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof l?t:new l(function(e){e(t)})).then(o,E)}r((c=c.apply(e,i||[])).next())})};!function(SOURCE_CONNECTOR){let t;(t||(t={})).events=[["RECIEVE_MEDIA",e=>{var t=JSON.parse(e.data);console.log(e.type,t)}],["VESSEL_ENTERED",e=>{var t=JSON.parse(e.data);o.appendChild(i(t.MONIKER)),console.log(e.type,t)}],["VESSEL_LEFT",e=>{var t=JSON.parse(e.data);document.querySelectorAll(`[vessel="${t.MONIKER}"]`).item(0).remove,console.log(e.type,t)}],["FORCEFUL_LEAVE",e=>{var t=JSON.parse(e.data);o.innerHTML="",console.log(e.type,t),n.close()}],["UNWORTHY",e=>{var t=JSON.parse(e.data);console.log(e.type,t),n.close()}]];let n;const o=document.getElementById("THE_LIST");let E;function r(){return l(this,void 0,void 0,function*(){let n;{let t=null;var o;let e;for(;yield(e=null!==(o=prompt(null===t?"Choose a MONIKER to wield for THE SOURCE.":t))?function(e){return fetch("THE_SOURCE/REQUEST_INVITATION/"+e.MONIKER_SUGGESTION).then(e=>l(this,void 0,void 0,function*(){if(202===e.status)return yield e.json();throw yield e.text()}),e=>{throw e})}({MONIKER_SUGGESTION:o}):e).then(e=>(n=e,!1),e=>(t=e,!0)););}return n})}function i(e){var t=document.createElement("div"),n=(t.setAttribute("vessel",e),document.createElement("img"));return n.src="COMPUTER_ICON",n.style.height="1rem",n.style.width="1rem",t.appendChild(n),t.appendChild(document.createTextNode(e)),t}SOURCE_CONNECTOR.SEND_MISSIVE_TO=function(e,t){return fetch(`THE_SOURCE/SEND/MISSIVE/${E.MONIKER}/${E.PASSWORD}/${e}/`+t).then(e=>l(this,void 0,void 0,function*(){if(202!==e.status)throw yield e.text()}),e=>{throw e})},SOURCE_CONNECTOR.SEND_RECORD_TO=function(e,t){return fetch(`THE_SOURCE/SEND/MISSIVE/${E.MONIKER}/${E.PASSWORD}/${e}/${t.FILENAME}/`+t.DATA).then(e=>l(this,void 0,void 0,function*(){if(202!==e.status)throw yield e.text()}),e=>{throw e})},l(this,void 0,void 0,function*(){var e;E=((e=yield r()).OTHER_VESSELS.forEach(e=>o.appendChild(i(e))),{MONIKER:e.MONIKER,PASSWORD:e.PASSWORD}),n=function(){let n=new EventSource(`THE_SOURCE/ENTER/${E.MONIKER}/`+E.PASSWORD);return n.onopen=e=>{console.log("entered THE SOURCE")},t.events.forEach(([e,t])=>{console.log(e),n.addEventListener(e,t)}),n}()})}(SOURCE_CONNECTOR=SOURCE_CONNECTOR||{});